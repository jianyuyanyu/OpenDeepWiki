---
title: AI 提供商配置
description: 为 OpenDeepWiki 中的 wiki 生成、聊天和翻译配置 AI 提供商。
---

import { Callout } from "fumadocs-ui/components/callout";

# AI 提供商配置

OpenDeepWiki 为三个不同的任务使用 AI 模型，每个都可独立配置：

| 任务 | 用途 | 环境变量前缀 |
|---|---|---|
| **聊天** | 对话式 AI 功能 | `CHAT_*`、`ENDPOINT` |
| **Wiki 目录** | 生成文档结构 | `WIKI_CATALOG_*` |
| **Wiki 内容** | 生成文档页面 | `WIKI_CONTENT_*` |
| **翻译**（可选） | 翻译文档 | `WIKI_TRANSLATION_*` |

所有任务都可以使用相同的提供商，或者为每个任务混合使用不同的提供商和模型。

## 支持的提供商

OpenDeepWiki 通过 `*_REQUEST_TYPE` 变量支持以下 AI 提供商类型：

| 类型 | 描述 |
|---|---|
| `OpenAI` | OpenAI API 和兼容端点（默认） |
| `AzureOpenAI` | Azure OpenAI 服务 |
| `OpenAIResponses` | OpenAI Responses API |
| `Anthropic` | Anthropic Claude API |

## OpenAI 配置

适用于官方 OpenAI API 和任何 OpenAI 兼容端点（例如 vLLM、Ollama、LiteLLM）。

```yaml title="compose.yaml"
environment:
  # 聊天
  - CHAT_API_KEY=sk-your-openai-key
  - ENDPOINT=https://api.openai.com/v1
  - CHAT_REQUEST_TYPE=OpenAI

  # Wiki 目录生成
  - WIKI_CATALOG_MODEL=gpt-4o
  - WIKI_CATALOG_ENDPOINT=https://api.openai.com/v1
  - WIKI_CATALOG_API_KEY=sk-your-openai-key
  - WIKI_CATALOG_REQUEST_TYPE=OpenAI

  # Wiki 内容生成
  - WIKI_CONTENT_MODEL=gpt-4o
  - WIKI_CONTENT_ENDPOINT=https://api.openai.com/v1
  - WIKI_CONTENT_API_KEY=sk-your-openai-key
  - WIKI_CONTENT_REQUEST_TYPE=OpenAI
```

### 为所有任务使用单个 API 密钥

如果为所有内容使用相同的 OpenAI 密钥，仍需要分别设置每个组。wiki 任务之间没有全局回退。

## Azure OpenAI 配置

对于 Azure OpenAI 服务，将请求类型设置为 `AzureOpenAI` 并使用你的 Azure 端点：

```yaml title="compose.yaml"
environment:
  # 聊天
  - CHAT_API_KEY=your-azure-api-key
  - ENDPOINT=https://your-resource.openai.azure.com/
  - CHAT_REQUEST_TYPE=AzureOpenAI

  # Wiki 目录生成
  - WIKI_CATALOG_MODEL=gpt-4o
  - WIKI_CATALOG_ENDPOINT=https://your-resource.openai.azure.com/
  - WIKI_CATALOG_API_KEY=your-azure-api-key
  - WIKI_CATALOG_REQUEST_TYPE=AzureOpenAI

  # Wiki 内容生成
  - WIKI_CONTENT_MODEL=gpt-4o
  - WIKI_CONTENT_ENDPOINT=https://your-resource.openai.azure.com/
  - WIKI_CONTENT_API_KEY=your-azure-api-key
  - WIKI_CONTENT_REQUEST_TYPE=AzureOpenAI
```

<Callout type="info">
  对于 Azure OpenAI，模型名称应与你的 Azure 部署名称匹配。
</Callout>

## Anthropic 配置

使用 Anthropic Claude 模型：

```yaml title="compose.yaml"
environment:
  # 聊天
  - CHAT_API_KEY=sk-ant-your-anthropic-key
  - ENDPOINT=https://api.anthropic.com
  - CHAT_REQUEST_TYPE=Anthropic

  # Wiki 目录生成
  - WIKI_CATALOG_MODEL=claude-sonnet-4-20250514
  - WIKI_CATALOG_ENDPOINT=https://api.anthropic.com
  - WIKI_CATALOG_API_KEY=sk-ant-your-anthropic-key
  - WIKI_CATALOG_REQUEST_TYPE=Anthropic

  # Wiki 内容生成
  - WIKI_CONTENT_MODEL=claude-sonnet-4-20250514
  - WIKI_CONTENT_ENDPOINT=https://api.anthropic.com
  - WIKI_CONTENT_API_KEY=sk-ant-your-anthropic-key
  - WIKI_CONTENT_REQUEST_TYPE=Anthropic
```

## 自定义/自托管提供商

任何 OpenAI 兼容的 API 都可以通过将端点设置为你的自定义服务器来使用：

```yaml title="compose.yaml"
environment:
  # 示例：Ollama
  - WIKI_CONTENT_MODEL=llama3
  - WIKI_CONTENT_ENDPOINT=http://ollama:11434/v1
  - WIKI_CONTENT_API_KEY=ollama
  - WIKI_CONTENT_REQUEST_TYPE=OpenAI

  # 示例：vLLM
  - WIKI_CATALOG_MODEL=your-model
  - WIKI_CATALOG_ENDPOINT=http://vllm-server:8000/v1
  - WIKI_CATALOG_API_KEY=token-abc123
  - WIKI_CATALOG_REQUEST_TYPE=OpenAI
```

## 翻译配置

翻译是可选的。如果未配置，将回退到 wiki 内容配置。

```yaml title="compose.yaml"
environment:
  # 翻译（可选 — 如果未设置，回退到内容配置）
  - WIKI_TRANSLATION_MODEL=gpt-4o
  - WIKI_TRANSLATION_ENDPOINT=https://api.openai.com/v1
  - WIKI_TRANSLATION_API_KEY=sk-your-key
  - WIKI_TRANSLATION_REQUEST_TYPE=OpenAI

  # 目标语言（逗号分隔）
  - WIKI_LANGUAGES=en,zh,ja,ko
```

## Wiki 生成选项

控制 wiki 生成行为的其他选项：

| 变量 | 默认值 | 描述 |
|---|---|---|
| `WIKI_PARALLEL_COUNT` | `5` | 并行文档生成任务数 |
| `WIKI_LANGUAGES` | `en,zh,ja,ko` | 目标语言的逗号分隔列表 |

这些也可以在 `appsettings.json` 的 `WikiGenerator` 部分设置：

```json title="appsettings.json"
{
  "WikiGenerator": {
    "CatalogModel": "gpt-4o",
    "ContentModel": "gpt-4o",
    "ParallelCount": 5,
    "MaxOutputTokens": 32000,
    "MaxRetryAttempts": 3,
    "Languages": "en,zh,ja,ko"
  }
}
```

## 完整环境变量参考

### 聊天 AI

| 变量 | 必需 | 默认值 | 描述 |
|---|---|---|---|
| `CHAT_API_KEY` | 是 | — | 聊天服务的 API 密钥 |
| `ENDPOINT` | 是 | `https://api.routin.ai/v1` | 聊天 AI 端点 |
| `CHAT_REQUEST_TYPE` | 否 | `OpenAI` | 提供商类型 |

### Wiki 目录生成

| 变量 | 必需 | 默认值 | 描述 |
|---|---|---|---|
| `WIKI_CATALOG_MODEL` | 否 | `gpt-4o` | 目录生成模型 |
| `WIKI_CATALOG_ENDPOINT` | 是 | — | 目录生成端点 |
| `WIKI_CATALOG_API_KEY` | 是 | — | 目录生成的 API 密钥 |
| `WIKI_CATALOG_REQUEST_TYPE` | 否 | `OpenAI` | 提供商类型 |

### Wiki 内容生成

| 变量 | 必需 | 默认值 | 描述 |
|---|---|---|---|
| `WIKI_CONTENT_MODEL` | 否 | `gpt-4o` | 内容生成模型 |
| `WIKI_CONTENT_ENDPOINT` | 是 | — | 内容生成端点 |
| `WIKI_CONTENT_API_KEY` | 是 | — | 内容生成的 API 密钥 |
| `WIKI_CONTENT_REQUEST_TYPE` | 否 | `OpenAI` | 提供商类型 |

### Wiki 翻译（可选）

| 变量 | 必需 | 默认值 | 描述 |
|---|---|---|---|
| `WIKI_TRANSLATION_MODEL` | 否 | 与内容模型相同 | 翻译模型 |
| `WIKI_TRANSLATION_ENDPOINT` | 否 | 与内容端点相同 | 翻译端点 |
| `WIKI_TRANSLATION_API_KEY` | 否 | 与内容 API 密钥相同 | 翻译的 API 密钥 |
| `WIKI_TRANSLATION_REQUEST_TYPE` | 否 | 与内容类型相同 | 提供商类型 |
